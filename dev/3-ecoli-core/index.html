<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Sensitivities of OFMs in E. coli core · ElementaryFluxModes.jl</title><meta name="title" content="Sensitivities of OFMs in E. coli core · ElementaryFluxModes.jl"/><meta property="og:title" content="Sensitivities of OFMs in E. coli core · ElementaryFluxModes.jl"/><meta property="twitter:title" content="Sensitivities of OFMs in E. coli core · ElementaryFluxModes.jl"/><meta name="description" content="Documentation for ElementaryFluxModes.jl."/><meta property="og:description" content="Documentation for ElementaryFluxModes.jl."/><meta property="twitter:description" content="Documentation for ElementaryFluxModes.jl."/><meta property="og:url" content="https://hettiec.github.io/ElementaryFluxModes.jl/3-ecoli-core/"/><meta property="twitter:url" content="https://hettiec.github.io/ElementaryFluxModes.jl/3-ecoli-core/"/><link rel="canonical" href="https://hettiec.github.io/ElementaryFluxModes.jl/3-ecoli-core/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ElementaryFluxModes.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">README</a></li><li><a class="tocitem" href="../1-toy-model/">Calculating EFMs in a toy model</a></li><li><a class="tocitem" href="../2-differentiate/">Sensitivities of the EFMs of a toy model</a></li><li class="is-active"><a class="tocitem" href>Sensitivities of OFMs in <em>E. coli</em> core</a><ul class="internal"><li><a class="tocitem" href="#Optimal-flux-modes-(OFMs)"><span>Optimal flux modes (OFMs)</span></a></li><li><a class="tocitem" href="#Differentiate-OFM-usage"><span>Differentiate OFM usage</span></a></li></ul></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Sensitivities of OFMs in <em>E. coli</em> core</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Sensitivities of OFMs in <em>E. coli</em> core</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/HettieC/ElementaryFluxModes.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/HettieC/ElementaryFluxModes.jl/blob/main/docs/src/3-ecoli-core.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Sensitivities-of-OFMs-in-*E.-coli*-core"><a class="docs-heading-anchor" href="#Sensitivities-of-OFMs-in-*E.-coli*-core">Sensitivities of OFMs in <em>E. coli</em> core</a><a id="Sensitivities-of-OFMs-in-*E.-coli*-core-1"></a><a class="docs-heading-anchor-permalink" href="#Sensitivities-of-OFMs-in-*E.-coli*-core" title="Permalink"></a></h1><pre><code class="language-julia hljs">using ElementaryFluxModes

import AbstractFBCModels as A
import AbstractFBCModels.CanonicalModel as CM
using JSONFBCModels
import FastDifferentiation as F
const Ex = F.Node
import DifferentiableMetabolism as D
using COBREXA
import COBREXA as X
using JSON
import Tulip as T
using CairoMakie</code></pre><p>It has been proven that enzyme constrained models with K constraints will use a maximum of K EFMs in their optimal solution (de Groot 2019).</p><p>Here, we take the <em>E. coli</em> core model with two enzyme constraints, find the optimal solution, and then find the EFMs in the optimal solution.</p><pre><code class="language-julia hljs">!isfile(&quot;e_coli_core.json&quot;) &amp;&amp;
    download(&quot;http://bigg.ucsd.edu/static/models/e_coli_core.json&quot;, &quot;e_coli_core.json&quot;)

include(&quot;../../test/data_static.jl&quot;)

model = convert(CM.Model, X.load_model(&quot;e_coli_core.json&quot;))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">AbstractFBCModels.CanonicalModel.Model(
  reactions = Dict{String, AbstractFBCModels.CanonicalModel.Reaction}(&quot;ACALD&quot; =&gt; AbstractFBCModels.CanonicalModel.Reaction(&quot;Acetaldehyde dehydrogenas…
  metabolites = Dict{String, AbstractFBCModels.CanonicalModel.Metabolite}(&quot;glu__L_c&quot; =&gt; AbstractFBCModels.CanonicalModel.Metabolite(&quot;L-Glutamate&quot;, &quot;c…
  genes = Dict{String, AbstractFBCModels.CanonicalModel.Gene}(&quot;b4301&quot; =&gt; AbstractFBCModels.CanonicalModel.Gene(&quot;sgcE&quot;, Dict(&quot;sbo&quot; =&gt; [&quot;SBO:0000243&quot;],…
  couplings = Dict{String, AbstractFBCModels.CanonicalModel.Coupling}(),
)
</code></pre><p>unconstrain glucose</p><pre><code class="language-julia hljs">model.reactions[&quot;EX_glc__D_e&quot;].lower_bound = -1000.0</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-1000.0</code></pre><p>constrain PFL to zero</p><pre><code class="language-julia hljs">model.reactions[&quot;PFL&quot;].upper_bound = 0.0

rid_kcat = Dict(k =&gt; Ex(Symbol(k)) for (k, _) in ecoli_core_reaction_kcats)
kcats = Symbol.(keys(ecoli_core_reaction_kcats))

float_reaction_isozymes = Dict{String,Dict{String,X.Isozyme}}()
for (rid, rxn) in model.reactions
    grrs = rxn.gene_association_dnf
    isnothing(grrs) &amp;&amp; continue # skip if no grr available
    haskey(ecoli_core_reaction_kcats, rid) || continue # skip if no kcat data available
    for (i, grr) in enumerate(grrs)

        kcat = ecoli_core_reaction_kcats[rid] * 3.6 # change unit to k/h

        d = get!(float_reaction_isozymes, rid, Dict{String,X.Isozyme}())
        d[&quot;isozyme_$i&quot;] = X.Isozyme(
            gene_product_stoichiometry=Dict(grr .=&gt; fill(1.0, size(grr))), # assume subunit stoichiometry of 1 for all isozymes
            kcat_forward=kcat, # assume forward and reverse have the same kcat
            kcat_reverse=kcat,
        )
    end
end

gene_product_molar_masses = Dict(k =&gt; v for (k, v) in ecoli_core_gene_product_masses)

capacity = [
    (
        &quot;membrane&quot;, # enzyme group names must be of type Symbol
        [x for (x, y) in ecoli_core_subcellular_location if y == &quot;membrane&quot;],
        15.0,
    ),
    (&quot;cytosol&quot;, [x for (x, y) in ecoli_core_subcellular_location if y == &quot;cytosol&quot;], 35.0),
]

ec_solution = X.enzyme_constrained_flux_balance_analysis(
    model;
    reaction_isozymes=float_reaction_isozymes,
    gene_product_molar_masses,
    capacity,
    optimizer=T.Optimizer,
)

ec_solution</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ConstraintTrees.Tree{Float64} with 12 elements:
  :coupling                     =&gt; ConstraintTrees.Tree{Float64}(#= 0 elements =#)
  :flux_stoichiometry           =&gt; ConstraintTrees.Tree{Float64}(#= 72 elements =#)
  :fluxes                       =&gt; ConstraintTrees.Tree{Float64}(#= 95 elements =#)
  :fluxes_forward               =&gt; ConstraintTrees.Tree{Float64}(#= 95 elements =#)
  :fluxes_reverse               =&gt; ConstraintTrees.Tree{Float64}(#= 95 elements =#)
  :gene_product_amounts         =&gt; ConstraintTrees.Tree{Float64}(#= 130 elements =#)
  :gene_product_capacity        =&gt; ConstraintTrees.Tree{Float64}(#= 2 elements =#)
  :isozyme_flux_forward_balance =&gt; ConstraintTrees.Tree{Float64}(#= 62 elements =#)
  :isozyme_flux_reverse_balance =&gt; ConstraintTrees.Tree{Float64}(#= 62 elements =#)
  :isozyme_forward_amounts      =&gt; ConstraintTrees.Tree{Float64}(#= 62 elements =#)
  :isozyme_reverse_amounts      =&gt; ConstraintTrees.Tree{Float64}(#= 62 elements =#)
  :objective                    =&gt; 0.740724</code></pre><p>This solution is both producing acetate and consuming oxygen, therefore it looks like overflow metabolism.</p><pre><code class="language-julia hljs">ec_solution.fluxes[&quot;EX_ac_e&quot;]
ec_solution.fluxes[&quot;EX_o2_e&quot;]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">-11.119604376947802</code></pre><p>Since we had two enzyme pools, the membrane and the cytosol, this optimal solution will be composed of at most two EFMs. In order to find out how small parameter changes will affect this optimal composition, we must first remove inactive reactions, so that the optimal solution is a unique superposition of the two EFMs, and we can differentiate it.</p><p>This solution contains many inactive reactions</p><pre><code class="language-julia hljs">sort(collect(ec_solution.fluxes), by=ComposedFunction(abs, last))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">95-element Vector{Pair{Symbol, Union{Float64, ConstraintTrees.Tree{Float64}}}}:
    :EX_fru_e =&gt; 0.0
    :EX_fum_e =&gt; 0.0
 :EX_gln__L_e =&gt; 0.0
 :EX_mal__L_e =&gt; 0.0
     :FRUpts2 =&gt; 0.0
     :FUMt2_2 =&gt; 0.0
      :GLNabc =&gt; 0.0
     :MALt2_2 =&gt; 0.0
         :PFL =&gt; 0.0
    :EX_for_e =&gt; 1.1751401296095953e-14
              ⋮
    :SUCCt2_2 =&gt; 45.1017515034113
      :SUCCt3 =&gt; 45.101751508128025
         :PDH =&gt; 48.64218610958069
         :ENO =&gt; 53.247640002202544
         :PGM =&gt; -53.24764000220255
    :EX_co2_e =&gt; 53.669000943520395
        :CO2t =&gt; -53.66900094352041
        :GAPD =&gt; 54.355763660340095
         :PGK =&gt; -54.355763660340095</code></pre><p>And also many inactive gene products.</p><pre><code class="language-julia hljs">sort(collect(ec_solution.gene_product_amounts), by=last)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">130-element Vector{Pair{Symbol, Union{Float64, ConstraintTrees.Tree{Float64}}}}:
 :b0902 =&gt; 0.0
 :b0903 =&gt; 0.0
 :b2579 =&gt; 0.0
 :b3114 =&gt; 0.0
 :b3951 =&gt; 0.0
 :b3952 =&gt; 0.0
 :b0809 =&gt; 2.9237052619941317e-16
 :b0810 =&gt; 2.9237052619941317e-16
 :b0811 =&gt; 2.9237052619941317e-16
 :b1702 =&gt; 3.9759214856671975e-12
        ⋮
 :b2415 =&gt; 0.0347023816798353
 :b2416 =&gt; 0.0347023816798353
 :b0978 =&gt; 0.040328743170719945
 :b0979 =&gt; 0.040328743170719945
 :b3528 =&gt; 0.053498438408503594
 :b2779 =&gt; 0.07065207134510235
 :b1779 =&gt; 0.11726330582717176
 :b1478 =&gt; 0.15248718085537333
 :b2926 =&gt; 0.2619504379992874</code></pre><p>Let us start by pruning the model.</p><pre><code class="language-julia hljs">flux_zero_tol = 1e-6 # these bounds make a real difference!
gene_zero_tol = 1e-6
pruned_model, pruned_reaction_isozymes = D.prune_model(
    model,
    ec_solution.fluxes,
    ec_solution.gene_product_amounts,
    float_reaction_isozymes,
    ec_solution.isozyme_forward_amounts,
    ec_solution.isozyme_reverse_amounts,
    flux_zero_tol,
    gene_zero_tol,
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(AbstractFBCModels.CanonicalModel.Model(Dict{String, AbstractFBCModels.CanonicalModel.Reaction}(&quot;ACALD&quot; =&gt; AbstractFBCModels.CanonicalModel.Reaction(&quot;Acetaldehyde dehydrogenase (acetylating)&quot;, 0.0, 1000.0, Dict(&quot;coa_c&quot; =&gt; 1.0, &quot;nad_c&quot; =&gt; 1.0, &quot;accoa_c&quot; =&gt; -1.0, &quot;acald_c&quot; =&gt; 1.0, &quot;h_c&quot; =&gt; -1.0, &quot;nadh_c&quot; =&gt; -1.0), 0.0, [[&quot;b0351&quot;], [&quot;b1241&quot;]], Dict(&quot;bigg.reaction&quot; =&gt; [&quot;ACALD&quot;], &quot;sabiork&quot; =&gt; [&quot;163&quot;], &quot;metanetx.reaction&quot; =&gt; [&quot;MNXR95210&quot;], &quot;rhea&quot; =&gt; [&quot;23290&quot;, &quot;23291&quot;, &quot;23289&quot;, &quot;23288&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000176&quot;], &quot;seed.reaction&quot; =&gt; [&quot;rxn00171&quot;], &quot;kegg.reaction&quot; =&gt; [&quot;R00228&quot;], &quot;biocyc&quot; =&gt; [&quot;META:ACETALD-DEHYDROG-RXN&quot;], &quot;ec-code&quot; =&gt; [&quot;1.2.1.10&quot;]), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;ACALD&quot;])), &quot;PTAr&quot; =&gt; AbstractFBCModels.CanonicalModel.Reaction(&quot;Phosphotransacetylase&quot;, 0.0, 1000.0, Dict(&quot;coa_c&quot; =&gt; 1.0, &quot;accoa_c&quot; =&gt; -1.0, &quot;actp_c&quot; =&gt; 1.0, &quot;pi_c&quot; =&gt; -1.0), 0.0, [[&quot;b2297&quot;], [&quot;b2458&quot;]], Dict(&quot;bigg.reaction&quot; =&gt; [&quot;PTAr&quot;], &quot;sabiork&quot; =&gt; [&quot;72&quot;], &quot;metanetx.reaction&quot; =&gt; [&quot;MNXR103319&quot;], &quot;rhea&quot; =&gt; [&quot;19521&quot;, &quot;19523&quot;, &quot;19522&quot;, &quot;19524&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000176&quot;], &quot;seed.reaction&quot; =&gt; [&quot;rxn00173&quot;], &quot;kegg.reaction&quot; =&gt; [&quot;R00230&quot;], &quot;biocyc&quot; =&gt; [&quot;META:PHOSACETYLTRANS-RXN&quot;], &quot;ec-code&quot; =&gt; [&quot;2.3.1.8&quot;]), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;PTAr&quot;])), &quot;ALCD2x&quot; =&gt; AbstractFBCModels.CanonicalModel.Reaction(&quot;Alcohol dehydrogenase (ethanol)&quot;, 0.0, 1000.0, Dict(&quot;nad_c&quot; =&gt; 1.0, &quot;acald_c&quot; =&gt; -1.0, &quot;etoh_c&quot; =&gt; 1.0, &quot;h_c&quot; =&gt; -1.0, &quot;nadh_c&quot; =&gt; -1.0), 0.0, [[&quot;b0356&quot;], [&quot;b1241&quot;], [&quot;b1478&quot;]], Dict(&quot;bigg.reaction&quot; =&gt; [&quot;ALCD2x&quot;], &quot;sabiork&quot; =&gt; [&quot;597&quot;], &quot;metanetx.reaction&quot; =&gt; [&quot;MNXR95725&quot;], &quot;rhea&quot; =&gt; [&quot;25292&quot;, &quot;25290&quot;, &quot;25291&quot;, &quot;25293&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000176&quot;], &quot;seed.reaction&quot; =&gt; [&quot;rxn00543&quot;], &quot;kegg.reaction&quot; =&gt; [&quot;R00754&quot;], &quot;biocyc&quot; =&gt; [&quot;META:ALCOHOL-DEHYDROG-RXN&quot;], &quot;reactome.reaction&quot; =&gt; [&quot;R-MMU-71707&quot;, &quot;R-XTR-71707&quot;, &quot;R-CFA-71707&quot;, &quot;R-OSA-71707&quot;, &quot;R-RNO-71707&quot;, &quot;R-HSA-71707&quot;, &quot;R-SSC-71707&quot;, &quot;R-GGA-71707&quot;, &quot;R-SPO-71707&quot;, &quot;R-DME-71707&quot;, &quot;R-DRE-71707&quot;, &quot;R-BTA-71707&quot;, &quot;R-ATH-71707&quot;, &quot;R-SCE-71707&quot;, &quot;R-TGU-71707&quot;, &quot;R-CEL-71707&quot;, &quot;R-DDI-71707&quot;], &quot;ec-code&quot; =&gt; [&quot;1.1.1.71&quot;, &quot;1.1.1.1&quot;]…), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;ALCD2x&quot;])), &quot;PDH&quot; =&gt; AbstractFBCModels.CanonicalModel.Reaction(&quot;Pyruvate dehydrogenase&quot;, 0.0, 1000.0, Dict(&quot;coa_c&quot; =&gt; -1.0, &quot;nad_c&quot; =&gt; -1.0, &quot;accoa_c&quot; =&gt; 1.0, &quot;co2_c&quot; =&gt; 1.0, &quot;pyr_c&quot; =&gt; -1.0, &quot;nadh_c&quot; =&gt; 1.0), 0.0, [[&quot;b0114&quot;, &quot;b0115&quot;, &quot;b0116&quot;]], Dict(&quot;bigg.reaction&quot; =&gt; [&quot;PDH&quot;], &quot;sabiork&quot; =&gt; [&quot;523&quot;], &quot;metanetx.reaction&quot; =&gt; [&quot;MNXR102425&quot;], &quot;rhea&quot; =&gt; [&quot;28043&quot;, &quot;28045&quot;, &quot;28044&quot;, &quot;28042&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000176&quot;], &quot;seed.reaction&quot; =&gt; [&quot;rxn00154&quot;], &quot;kegg.reaction&quot; =&gt; [&quot;R00209&quot;], &quot;biocyc&quot; =&gt; [&quot;META:PYRUVDEH-RXN&quot;], &quot;reactome.reaction&quot; =&gt; [&quot;R-RNO-71397&quot;, &quot;R-OSA-71397&quot;, &quot;R-GGA-373177&quot;, &quot;R-DME-71397&quot;, &quot;R-TGU-71397&quot;, &quot;R-XTR-71397&quot;, &quot;R-CFA-71397&quot;, &quot;R-BTA-71397&quot;, &quot;R-HSA-71397&quot;, &quot;R-GGA-71397&quot;, &quot;R-SPO-71397&quot;, &quot;R-CEL-71397&quot;, &quot;R-DDI-71397&quot;, &quot;R-DRE-71397&quot;, &quot;R-SSC-71397&quot;, &quot;R-SCE-71397&quot;, &quot;R-ATH-71397&quot;, &quot;R-MMU-71397&quot;], &quot;ec-code&quot; =&gt; [&quot;1.2.1&quot;, &quot;1.8.1.4&quot;, &quot;1.2.1.51&quot;, &quot;1.2.4.1&quot;, &quot;2.3.1.12&quot;]…), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;PDH&quot;])), &quot;CO2t&quot; =&gt; AbstractFBCModels.CanonicalModel.Reaction(&quot;CO2 transporter via diffusion&quot;, 0.0, 1000.0, Dict(&quot;co2_e&quot; =&gt; 1.0, &quot;co2_c&quot; =&gt; -1.0), 0.0, [[&quot;s0001&quot;]], Dict(&quot;metanetx.reaction&quot; =&gt; [&quot;MNXR96810&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000185&quot;], &quot;seed.reaction&quot; =&gt; [&quot;rxn05467&quot;, &quot;rxn08237&quot;, &quot;rxn09706&quot;, &quot;rxn09821&quot;, &quot;rxn09775&quot;, &quot;rxn09876&quot;, &quot;rxn08238&quot;, &quot;rxn09860&quot;], &quot;biocyc&quot; =&gt; [&quot;META:TRANS-RXN0-545&quot;], &quot;reactome.reaction&quot; =&gt; [&quot;R-DDI-1247645&quot;, &quot;R-CFA-1237069&quot;, &quot;R-TGU-1247649&quot;, &quot;R-CFA-1237042&quot;, &quot;R-CEL-1247645&quot;, &quot;R-XTR-1237069&quot;, &quot;R-HSA-1247645&quot;, &quot;R-OSA-1237042&quot;, &quot;R-GGA-1237042&quot;, &quot;R-BTA-1247645&quot;  …  &quot;R-MMU-1247645&quot;, &quot;R-DME-1237069&quot;, &quot;R-RNO-1237042&quot;, &quot;R-TGU-1247645&quot;, &quot;R-BTA-1237042&quot;, &quot;R-GGA-1237069&quot;, &quot;R-DME-1247649&quot;, &quot;R-SSC-1237069&quot;, &quot;R-DRE-1237069&quot;, &quot;R-ATH-1247649&quot;], &quot;bigg.reaction&quot; =&gt; [&quot;CO2t&quot;]), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;CO2t&quot;])), &quot;PYK&quot; =&gt; AbstractFBCModels.CanonicalModel.Reaction(&quot;Pyruvate kinase&quot;, 0.0, 1000.0, Dict(&quot;adp_c&quot; =&gt; -1.0, &quot;atp_c&quot; =&gt; 1.0, &quot;pep_c&quot; =&gt; -1.0, &quot;pyr_c&quot; =&gt; 1.0, &quot;h_c&quot; =&gt; -1.0), 0.0, [[&quot;b1676&quot;], [&quot;b1854&quot;]], Dict(&quot;bigg.reaction&quot; =&gt; [&quot;PYK&quot;], &quot;sabiork&quot; =&gt; [&quot;9&quot;], &quot;metanetx.reaction&quot; =&gt; [&quot;MNXR103371&quot;], &quot;rhea&quot; =&gt; [&quot;18160&quot;, &quot;18159&quot;, &quot;18158&quot;, &quot;18157&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000176&quot;], &quot;seed.reaction&quot; =&gt; [&quot;rxn00148&quot;], &quot;kegg.reaction&quot; =&gt; [&quot;R00200&quot;], &quot;biocyc&quot; =&gt; [&quot;META:PEPDEPHOS-RXN&quot;], &quot;reactome.reaction&quot; =&gt; [&quot;R-SSC-71670&quot;, &quot;R-GGA-353056&quot;, &quot;R-DRE-71670&quot;, &quot;R-OSA-71670&quot;, &quot;R-SPO-71670&quot;, &quot;R-DDI-71670&quot;, &quot;R-SCE-71670&quot;, &quot;R-CEL-71670&quot;, &quot;R-PFA-71670&quot;, &quot;R-HSA-71670&quot;, &quot;R-TGU-71670&quot;, &quot;R-DME-71670&quot;, &quot;R-ATH-71670&quot;, &quot;R-BTA-71670&quot;, &quot;R-MMU-71670&quot;, &quot;R-RNO-71670&quot;, &quot;R-GGA-71670&quot;, &quot;R-CFA-71670&quot;, &quot;R-XTR-71670&quot;], &quot;ec-code&quot; =&gt; [&quot;2.7.1.40&quot;]…), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;PYK&quot;])), &quot;EX_nh4_e&quot; =&gt; AbstractFBCModels.CanonicalModel.Reaction(&quot;Ammonia exchange&quot;, 0.0, 1000.0, Dict(&quot;nh4_e&quot; =&gt; 1.0), 0.0, nothing, Dict(&quot;sabiork&quot; =&gt; [&quot;11683&quot;], &quot;metanetx.reaction&quot; =&gt; [&quot;MNXR101950&quot;], &quot;rhea&quot; =&gt; [&quot;28749&quot;, &quot;28748&quot;, &quot;28750&quot;, &quot;28747&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000627&quot;], &quot;seed.reaction&quot; =&gt; [&quot;rxn13364&quot;, &quot;rxn09835&quot;, &quot;rxn05466&quot;, &quot;rxn08987&quot;, &quot;rxn08986&quot;, &quot;rxn09736&quot;], &quot;biocyc&quot; =&gt; [&quot;META:TRANS-RXN0-206&quot;, &quot;META:RXN-9615&quot;, &quot;META:TRANS-RXN0-544&quot;], &quot;reactome.reaction&quot; =&gt; [&quot;R-CEL-444416&quot;, &quot;R-SSC-444416&quot;, &quot;R-DDI-444416&quot;, &quot;R-MMU-444416&quot;, &quot;R-DRE-444416&quot;, &quot;R-GGA-444416&quot;, &quot;R-CFA-444416&quot;, &quot;R-HSA-444416&quot;, &quot;R-XTR-444416&quot;, &quot;R-BTA-444416&quot;, &quot;R-RNO-444416&quot;, &quot;R-TGU-444416&quot;, &quot;R-DME-444416&quot;], &quot;bigg.reaction&quot; =&gt; [&quot;EX_nh4_e&quot;]), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;EX_nh4_e&quot;])), &quot;CS&quot; =&gt; AbstractFBCModels.CanonicalModel.Reaction(&quot;Citrate synthase&quot;, 0.0, 1000.0, Dict(&quot;coa_c&quot; =&gt; 1.0, &quot;h2o_c&quot; =&gt; -1.0, &quot;accoa_c&quot; =&gt; -1.0, &quot;cit_c&quot; =&gt; 1.0, &quot;oaa_c&quot; =&gt; -1.0, &quot;h_c&quot; =&gt; 1.0), 0.0, [[&quot;b0720&quot;]], Dict(&quot;bigg.reaction&quot; =&gt; [&quot;CS&quot;], &quot;sabiork&quot; =&gt; [&quot;267&quot;], &quot;metanetx.reaction&quot; =&gt; [&quot;MNXR96920&quot;], &quot;rhea&quot; =&gt; [&quot;16847&quot;, &quot;16846&quot;, &quot;16845&quot;, &quot;16848&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000176&quot;], &quot;seed.reaction&quot; =&gt; [&quot;rxn00256&quot;], &quot;kegg.reaction&quot; =&gt; [&quot;R00351&quot;], &quot;biocyc&quot; =&gt; [&quot;META:CITSYN-RXN&quot;, &quot;META:RXN-14905&quot;], &quot;reactome.reaction&quot; =&gt; [&quot;R-GGA-373006&quot;, &quot;R-GGA-70975&quot;, &quot;R-CEL-70975&quot;, &quot;R-HSA-70975&quot;, &quot;R-DRE-70975&quot;, &quot;R-MMU-70975&quot;, &quot;R-ATH-70975&quot;, &quot;R-SPO-70975&quot;, &quot;R-OSA-70975&quot;, &quot;R-SCE-70975&quot;, &quot;R-SSC-70975&quot;, &quot;R-DDI-70975&quot;, &quot;R-RNO-70975&quot;, &quot;R-DME-70975&quot;, &quot;R-PFA-70975&quot;, &quot;R-XTR-70975&quot;, &quot;R-CFA-70975&quot;, &quot;R-BTA-70975&quot;], &quot;ec-code&quot; =&gt; [&quot;2.3.3.16&quot;, &quot;2.3.3.1&quot;, &quot;2.3.3.3&quot;]…), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;CS&quot;])), &quot;PGM&quot; =&gt; AbstractFBCModels.CanonicalModel.Reaction(&quot;Phosphoglycerate mutase&quot;, 0.0, 1000.0, Dict(&quot;3pg_c&quot; =&gt; -1.0, &quot;2pg_c&quot; =&gt; 1.0), 0.0, [[&quot;b0755&quot;], [&quot;b3612&quot;], [&quot;b4395&quot;]], Dict(&quot;bigg.reaction&quot; =&gt; [&quot;PGM&quot;], &quot;sabiork&quot; =&gt; [&quot;7641&quot;], &quot;metanetx.reaction&quot; =&gt; [&quot;MNXR102547&quot;], &quot;rhea&quot; =&gt; [&quot;15902&quot;, &quot;15903&quot;, &quot;15901&quot;, &quot;15904&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000176&quot;], &quot;seed.reaction&quot; =&gt; [&quot;rxn01106&quot;], &quot;kegg.reaction&quot; =&gt; [&quot;R01518&quot;], &quot;biocyc&quot; =&gt; [&quot;META:3PGAREARR-RXN&quot;, &quot;META:RXN-15513&quot;], &quot;reactome.reaction&quot; =&gt; [&quot;R-XTR-71654&quot;, &quot;R-SSC-71654&quot;, &quot;R-DME-71445&quot;, &quot;R-XTR-71445&quot;, &quot;R-RNO-71445&quot;, &quot;R-GGA-71654&quot;, &quot;R-SSC-71445&quot;, &quot;R-GGA-71445&quot;, &quot;R-DDI-71654&quot;, &quot;R-SPO-71654&quot;  …  &quot;R-DDI-71445&quot;, &quot;R-RNO-71654&quot;, &quot;R-DRE-71445&quot;, &quot;R-OSA-71445&quot;, &quot;R-PFA-71654&quot;, &quot;R-DME-71654&quot;, &quot;R-TGU-71445&quot;, &quot;R-SCE-71445&quot;, &quot;R-ATH-71445&quot;, &quot;R-SCE-71654&quot;], &quot;ec-code&quot; =&gt; [&quot;5.4.2.1&quot;, &quot;5.4.2.11&quot;, &quot;5.4.2.12&quot;]…), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;PGM&quot;])), &quot;TKT1&quot; =&gt; AbstractFBCModels.CanonicalModel.Reaction(&quot;Transketolase&quot;, 0.0, 1000.0, Dict(&quot;g3p_c&quot; =&gt; 1.0, &quot;r5p_c&quot; =&gt; -1.0, &quot;s7p_c&quot; =&gt; 1.0, &quot;xu5p__D_c&quot; =&gt; -1.0), 0.0, [[&quot;b2465&quot;], [&quot;b2935&quot;]], Dict(&quot;bigg.reaction&quot; =&gt; [&quot;TKT1&quot;], &quot;metanetx.reaction&quot; =&gt; [&quot;MNXR104868&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000176&quot;], &quot;ec-code&quot; =&gt; [&quot;2.2.1.1&quot;]), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;TKT1&quot;]))…), Dict{String, AbstractFBCModels.CanonicalModel.Metabolite}(&quot;glu__L_c&quot; =&gt; AbstractFBCModels.CanonicalModel.Metabolite(&quot;L-Glutamate&quot;, &quot;c&quot;, Dict(&quot;C&quot; =&gt; 5, &quot;N&quot; =&gt; 1, &quot;H&quot; =&gt; 8, &quot;O&quot; =&gt; 4), -1, 0.0, Dict(&quot;kegg.drug&quot; =&gt; [&quot;D00007&quot;, &quot;D04341&quot;], &quot;kegg.compound&quot; =&gt; [&quot;C00025&quot;, &quot;C00302&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000247&quot;], &quot;biocyc&quot; =&gt; [&quot;META:Glutamates&quot;, &quot;META:GLT&quot;], &quot;chebi&quot; =&gt; [&quot;CHEBI:76051&quot;, &quot;CHEBI:21301&quot;, &quot;CHEBI:29985&quot;, &quot;CHEBI:42825&quot;, &quot;CHEBI:29987&quot;, &quot;CHEBI:18237&quot;, &quot;CHEBI:24314&quot;, &quot;CHEBI:16015&quot;, &quot;CHEBI:13107&quot;, &quot;CHEBI:5431&quot;, &quot;CHEBI:21304&quot;, &quot;CHEBI:6224&quot;, &quot;CHEBI:14321&quot;, &quot;CHEBI:29988&quot;], &quot;bigg.metabolite&quot; =&gt; [&quot;glu__L&quot;], &quot;seed.compound&quot; =&gt; [&quot;cpd27177&quot;, &quot;cpd00023&quot;, &quot;cpd19002&quot;], &quot;sabiork&quot; =&gt; [&quot;73&quot;, &quot;2010&quot;], &quot;metanetx.chemical&quot; =&gt; [&quot;MNXM89557&quot;], &quot;inchi_key&quot; =&gt; [&quot;WHUUTDBJXJRKMK-VKHMYHEASA-M&quot;]…), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;glu_L_c&quot;])), &quot;icit_c&quot; =&gt; AbstractFBCModels.CanonicalModel.Metabolite(&quot;Isocitrate&quot;, &quot;c&quot;, Dict(&quot;C&quot; =&gt; 6, &quot;H&quot; =&gt; 5, &quot;O&quot; =&gt; 7), -3, 0.0, Dict(&quot;chebi&quot; =&gt; [&quot;CHEBI:16087&quot;, &quot;CHEBI:36454&quot;, &quot;CHEBI:5998&quot;, &quot;CHEBI:24886&quot;, &quot;CHEBI:36453&quot;, &quot;CHEBI:14465&quot;, &quot;CHEBI:30887&quot;, &quot;CHEBI:24884&quot;], &quot;metanetx.chemical&quot; =&gt; [&quot;MNXM89661&quot;], &quot;inchi_key&quot; =&gt; [&quot;ODBLHEXUDAPZAU-UHFFFAOYSA-K&quot;], &quot;kegg.compound&quot; =&gt; [&quot;C00311&quot;], &quot;hmdb&quot; =&gt; [&quot;HMDB00193&quot;], &quot;sabiork&quot; =&gt; [&quot;2013&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000247&quot;], &quot;bigg.metabolite&quot; =&gt; [&quot;icit&quot;], &quot;seed.compound&quot; =&gt; [&quot;cpd00260&quot;]), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;icit_c&quot;])), &quot;co2_c&quot; =&gt; AbstractFBCModels.CanonicalModel.Metabolite(&quot;CO2 CO2&quot;, &quot;c&quot;, Dict(&quot;C&quot; =&gt; 1, &quot;O&quot; =&gt; 2), 0, 0.0, Dict(&quot;envipath&quot; =&gt; [&quot;650babc9-9d68-4b73-9332-11972ca26f7b/compound/2ec3da94-5f50-4525-81b1-5607c5c7a3d3&quot;, &quot;32de3cf4-e3e6-4168-956e-32fa5ddb0ce1/compound/05f60af4-0a3f-4ead-9a29-33bb0f123379&quot;], &quot;kegg.drug&quot; =&gt; [&quot;D00004&quot;], &quot;kegg.compound&quot; =&gt; [&quot;C00011&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000247&quot;], &quot;biocyc&quot; =&gt; [&quot;META:CARBON-DIOXIDE&quot;], &quot;chebi&quot; =&gt; [&quot;CHEBI:23011&quot;, &quot;CHEBI:3283&quot;, &quot;CHEBI:48829&quot;, &quot;CHEBI:16526&quot;, &quot;CHEBI:13283&quot;, &quot;CHEBI:13285&quot;, &quot;CHEBI:13284&quot;, &quot;CHEBI:13282&quot;], &quot;bigg.metabolite&quot; =&gt; [&quot;co2&quot;], &quot;seed.compound&quot; =&gt; [&quot;cpd00011&quot;], &quot;sabiork&quot; =&gt; [&quot;1266&quot;], &quot;metanetx.chemical&quot; =&gt; [&quot;MNXM13&quot;]…), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;co2_c&quot;])), &quot;6pgl_c&quot; =&gt; AbstractFBCModels.CanonicalModel.Metabolite(&quot;6-phospho-D-glucono-1,5-lactone&quot;, &quot;c&quot;, Dict(&quot;C&quot; =&gt; 6, &quot;P&quot; =&gt; 1, &quot;H&quot; =&gt; 9, &quot;O&quot; =&gt; 9), -2, 0.0, Dict(&quot;kegg.compound&quot; =&gt; [&quot;C01236&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000247&quot;], &quot;biocyc&quot; =&gt; [&quot;META:D-6-P-GLUCONO-DELTA-LACTONE&quot;], &quot;chebi&quot; =&gt; [&quot;CHEBI:12233&quot;, &quot;CHEBI:4160&quot;, &quot;CHEBI:57955&quot;, &quot;CHEBI:16938&quot;, &quot;CHEBI:20989&quot;, &quot;CHEBI:12958&quot;], &quot;bigg.metabolite&quot; =&gt; [&quot;6pgl&quot;], &quot;seed.compound&quot; =&gt; [&quot;cpd00911&quot;], &quot;sabiork&quot; =&gt; [&quot;1366&quot;], &quot;metanetx.chemical&quot; =&gt; [&quot;MNXM429&quot;], &quot;inchi_key&quot; =&gt; [&quot;IJOJIVNDFQSGAB-SQOUGZDYSA-L&quot;], &quot;hmdb&quot; =&gt; [&quot;HMDB62628&quot;, &quot;HMDB01127&quot;]…), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;6pgl_c&quot;])), &quot;cit_c&quot; =&gt; AbstractFBCModels.CanonicalModel.Metabolite(&quot;Citrate&quot;, &quot;c&quot;, Dict(&quot;C&quot; =&gt; 6, &quot;H&quot; =&gt; 5, &quot;O&quot; =&gt; 7), -3, 0.0, Dict(&quot;kegg.drug&quot; =&gt; [&quot;D00037&quot;], &quot;kegg.compound&quot; =&gt; [&quot;C00158&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000247&quot;], &quot;biocyc&quot; =&gt; [&quot;META:CIT&quot;], &quot;chebi&quot; =&gt; [&quot;CHEBI:35802&quot;, &quot;CHEBI:133748&quot;, &quot;CHEBI:35809&quot;, &quot;CHEBI:76049&quot;, &quot;CHEBI:41523&quot;, &quot;CHEBI:35810&quot;, &quot;CHEBI:30769&quot;, &quot;CHEBI:13999&quot;, &quot;CHEBI:23322&quot;, &quot;CHEBI:35808&quot;, &quot;CHEBI:42563&quot;, &quot;CHEBI:16947&quot;, &quot;CHEBI:132362&quot;, &quot;CHEBI:35804&quot;, &quot;CHEBI:23321&quot;, &quot;CHEBI:3727&quot;, &quot;CHEBI:35806&quot;], &quot;bigg.metabolite&quot; =&gt; [&quot;cit&quot;], &quot;seed.compound&quot; =&gt; [&quot;cpd00137&quot;], &quot;sabiork&quot; =&gt; [&quot;1952&quot;], &quot;metanetx.chemical&quot; =&gt; [&quot;MNXM131&quot;], &quot;inchi_key&quot; =&gt; [&quot;KRKNYBCHXYNGOX-UHFFFAOYSA-K&quot;]…), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;cit_c&quot;])), &quot;glc__D_e&quot; =&gt; AbstractFBCModels.CanonicalModel.Metabolite(&quot;D-Glucose&quot;, &quot;e&quot;, Dict(&quot;C&quot; =&gt; 6, &quot;H&quot; =&gt; 12, &quot;O&quot; =&gt; 6), 0, 0.0, Dict(&quot;kegg.drug&quot; =&gt; [&quot;D00009&quot;], &quot;kegg.compound&quot; =&gt; [&quot;C00031&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000247&quot;], &quot;biocyc&quot; =&gt; [&quot;META:Glucopyranose&quot;], &quot;chebi&quot; =&gt; [&quot;CHEBI:12965&quot;, &quot;CHEBI:20999&quot;, &quot;CHEBI:4167&quot;, &quot;CHEBI:17634&quot;], &quot;bigg.metabolite&quot; =&gt; [&quot;glc__D&quot;], &quot;seed.compound&quot; =&gt; [&quot;cpd26821&quot;, &quot;cpd00027&quot;], &quot;sabiork&quot; =&gt; [&quot;1406&quot;, &quot;1407&quot;], &quot;metanetx.chemical&quot; =&gt; [&quot;MNXM41&quot;], &quot;inchi_key&quot; =&gt; [&quot;WQZGKKKJIJFFOK-GASJEMHNSA-N&quot;]…), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;glc_D_e&quot;])), &quot;nadh_c&quot; =&gt; AbstractFBCModels.CanonicalModel.Metabolite(&quot;Nicotinamide adenine dinucleotide - reduced&quot;, &quot;c&quot;, Dict(&quot;C&quot; =&gt; 21, &quot;N&quot; =&gt; 7, &quot;P&quot; =&gt; 2, &quot;H&quot; =&gt; 27, &quot;O&quot; =&gt; 14), -2, 0.0, Dict(&quot;kegg.compound&quot; =&gt; [&quot;C00004&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000247&quot;], &quot;biocyc&quot; =&gt; [&quot;META:NADH&quot;], &quot;chebi&quot; =&gt; [&quot;CHEBI:13395&quot;, &quot;CHEBI:21902&quot;, &quot;CHEBI:7423&quot;, &quot;CHEBI:44216&quot;, &quot;CHEBI:57945&quot;, &quot;CHEBI:16908&quot;, &quot;CHEBI:13396&quot;], &quot;bigg.metabolite&quot; =&gt; [&quot;nadh&quot;], &quot;seed.compound&quot; =&gt; [&quot;cpd00004&quot;], &quot;sabiork&quot; =&gt; [&quot;38&quot;], &quot;metanetx.chemical&quot; =&gt; [&quot;MNXM10&quot;], &quot;inchi_key&quot; =&gt; [&quot;BOPGDPNILDQYTO-NNYOXOHSSA-L&quot;], &quot;hmdb&quot; =&gt; [&quot;HMDB01487&quot;]…), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;nadh_c&quot;])), &quot;coa_c&quot; =&gt; AbstractFBCModels.CanonicalModel.Metabolite(&quot;Coenzyme A&quot;, &quot;c&quot;, Dict(&quot;S&quot; =&gt; 1, &quot;C&quot; =&gt; 21, &quot;N&quot; =&gt; 7, &quot;P&quot; =&gt; 3, &quot;H&quot; =&gt; 32, &quot;O&quot; =&gt; 16), -4, 0.0, Dict(&quot;envipath&quot; =&gt; [&quot;32de3cf4-e3e6-4168-956e-32fa5ddb0ce1/compound/19310484-6aa5-4dcf-b1da-855a8c21ecfd&quot;], &quot;kegg.compound&quot; =&gt; [&quot;C00010&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000247&quot;], &quot;biocyc&quot; =&gt; [&quot;META:COA-GROUP&quot;, &quot;META:CO-A&quot;], &quot;chebi&quot; =&gt; [&quot;CHEBI:41631&quot;, &quot;CHEBI:41597&quot;, &quot;CHEBI:741566&quot;, &quot;CHEBI:23355&quot;, &quot;CHEBI:13295&quot;, &quot;CHEBI:13298&quot;, &quot;CHEBI:57287&quot;, &quot;CHEBI:15346&quot;, &quot;CHEBI:3771&quot;, &quot;CHEBI:13294&quot;], &quot;bigg.metabolite&quot; =&gt; [&quot;coa&quot;], &quot;seed.compound&quot; =&gt; [&quot;cpd22528&quot;, &quot;cpd00010&quot;], &quot;sabiork&quot; =&gt; [&quot;1265&quot;], &quot;metanetx.chemical&quot; =&gt; [&quot;MNXM12&quot;], &quot;inchi_key&quot; =&gt; [&quot;RGJOEKWQDUBAIZ-IBOSZNHHSA-J&quot;]…), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;coa_c&quot;])), &quot;g3p_c&quot; =&gt; AbstractFBCModels.CanonicalModel.Metabolite(&quot;Glyceraldehyde 3-phosphate&quot;, &quot;c&quot;, Dict(&quot;C&quot; =&gt; 3, &quot;P&quot; =&gt; 1, &quot;H&quot; =&gt; 5, &quot;O&quot; =&gt; 6), -2, 0.0, Dict(&quot;kegg.compound&quot; =&gt; [&quot;C00661&quot;, &quot;C00118&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000247&quot;], &quot;biocyc&quot; =&gt; [&quot;META:GAP&quot;], &quot;chebi&quot; =&gt; [&quot;CHEBI:5446&quot;, &quot;CHEBI:14333&quot;, &quot;CHEBI:12984&quot;, &quot;CHEBI:181&quot;, &quot;CHEBI:17138&quot;, &quot;CHEBI:21026&quot;, &quot;CHEBI:12983&quot;, &quot;CHEBI:18324&quot;, &quot;CHEBI:58027&quot;, &quot;CHEBI:59776&quot;, &quot;CHEBI:29052&quot;], &quot;bigg.metabolite&quot; =&gt; [&quot;g3p&quot;], &quot;seed.compound&quot; =&gt; [&quot;cpd00102&quot;, &quot;cpd19005&quot;], &quot;sabiork&quot; =&gt; [&quot;27&quot;, &quot;1687&quot;], &quot;metanetx.chemical&quot; =&gt; [&quot;MNXM74&quot;], &quot;inchi_key&quot; =&gt; [&quot;LXJXRIRHZLFYRP-VKHMYHEASA-L&quot;], &quot;hmdb&quot; =&gt; [&quot;HMDB01112&quot;]…), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;g3p_c&quot;])), &quot;nad_c&quot; =&gt; AbstractFBCModels.CanonicalModel.Metabolite(&quot;Nicotinamide adenine dinucleotide&quot;, &quot;c&quot;, Dict(&quot;C&quot; =&gt; 21, &quot;N&quot; =&gt; 7, &quot;P&quot; =&gt; 2, &quot;H&quot; =&gt; 26, &quot;O&quot; =&gt; 14), -1, 0.0, Dict(&quot;kegg.drug&quot; =&gt; [&quot;D00002&quot;], &quot;kegg.compound&quot; =&gt; [&quot;C00003&quot;], &quot;sbo&quot; =&gt; [&quot;SBO:0000247&quot;], &quot;biocyc&quot; =&gt; [&quot;META:NAD&quot;], &quot;chebi&quot; =&gt; [&quot;CHEBI:7422&quot;, &quot;CHEBI:44215&quot;, &quot;CHEBI:13394&quot;, &quot;CHEBI:21901&quot;, &quot;CHEBI:57540&quot;, &quot;CHEBI:15846&quot;, &quot;CHEBI:44281&quot;, &quot;CHEBI:44214&quot;, &quot;CHEBI:13393&quot;, &quot;CHEBI:29867&quot;], &quot;bigg.metabolite&quot; =&gt; [&quot;nad&quot;], &quot;seed.compound&quot; =&gt; [&quot;cpd00003&quot;], &quot;sabiork&quot; =&gt; [&quot;37&quot;], &quot;metanetx.chemical&quot; =&gt; [&quot;MNXM8&quot;], &quot;inchi_key&quot; =&gt; [&quot;BAWFJGJZGIEFAR-NNYOXOHSSA-M&quot;]…), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;nad_c&quot;]))…), Dict{String, AbstractFBCModels.CanonicalModel.Gene}(&quot;b4301&quot; =&gt; AbstractFBCModels.CanonicalModel.Gene(&quot;sgcE&quot;, Dict(&quot;sbo&quot; =&gt; [&quot;SBO:0000243&quot;], &quot;uniprot&quot; =&gt; [&quot;P39362&quot;], &quot;ecogene&quot; =&gt; [&quot;EG12553&quot;], &quot;ncbigene&quot; =&gt; [&quot;948829&quot;], &quot;ncbigi&quot; =&gt; [&quot;16132122&quot;], &quot;refseq_locus_tag&quot; =&gt; [&quot;b4301&quot;], &quot;refseq_name&quot; =&gt; [&quot;sgcE&quot;], &quot;asap&quot; =&gt; [&quot;ABE-0014097&quot;], &quot;refseq_synonym&quot; =&gt; [&quot;JW4263&quot;, &quot;ECK4290&quot;, &quot;yjhK&quot;]), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;b4301&quot;])), &quot;b1779&quot; =&gt; AbstractFBCModels.CanonicalModel.Gene(&quot;gapA&quot;, Dict(&quot;sbo&quot; =&gt; [&quot;SBO:0000243&quot;], &quot;uniprot&quot; =&gt; [&quot;P0A9B2&quot;], &quot;ecogene&quot; =&gt; [&quot;EG10367&quot;], &quot;ncbigene&quot; =&gt; [&quot;947679&quot;], &quot;ncbigi&quot; =&gt; [&quot;16129733&quot;], &quot;refseq_locus_tag&quot; =&gt; [&quot;b1779&quot;], &quot;refseq_name&quot; =&gt; [&quot;gapA&quot;], &quot;asap&quot; =&gt; [&quot;ABE-0005920&quot;], &quot;refseq_synonym&quot; =&gt; [&quot;ECK1777&quot;, &quot;JW1768&quot;]), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;b1779&quot;])), &quot;b2276&quot; =&gt; AbstractFBCModels.CanonicalModel.Gene(&quot;nuoN&quot;, Dict(&quot;sbo&quot; =&gt; [&quot;SBO:0000243&quot;], &quot;uniprot&quot; =&gt; [&quot;P0AFF0&quot;], &quot;ecogene&quot; =&gt; [&quot;EG12093&quot;], &quot;ncbigene&quot; =&gt; [&quot;945136&quot;], &quot;ncbigi&quot; =&gt; [&quot;145698289&quot;], &quot;refseq_locus_tag&quot; =&gt; [&quot;b2276&quot;], &quot;refseq_name&quot; =&gt; [&quot;nuoN&quot;], &quot;asap&quot; =&gt; [&quot;ABE-0007526&quot;], &quot;refseq_synonym&quot; =&gt; [&quot;JW2271&quot;, &quot;ECK2270&quot;]), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;b2276&quot;])), &quot;b1761&quot; =&gt; AbstractFBCModels.CanonicalModel.Gene(&quot;gdhA&quot;, Dict(&quot;sbo&quot; =&gt; [&quot;SBO:0000243&quot;], &quot;uniprot&quot; =&gt; [&quot;P00370&quot;], &quot;ecogene&quot; =&gt; [&quot;EG10372&quot;], &quot;ncbigene&quot; =&gt; [&quot;946802&quot;], &quot;ncbigi&quot; =&gt; [&quot;16129715&quot;], &quot;refseq_locus_tag&quot; =&gt; [&quot;b1761&quot;], &quot;refseq_name&quot; =&gt; [&quot;gdhA&quot;], &quot;asap&quot; =&gt; [&quot;ABE-0005865&quot;], &quot;refseq_synonym&quot; =&gt; [&quot;ECK1759&quot;, &quot;JW1750&quot;]), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;b1761&quot;])), &quot;b3493&quot; =&gt; AbstractFBCModels.CanonicalModel.Gene(&quot;pitA&quot;, Dict(&quot;sbo&quot; =&gt; [&quot;SBO:0000243&quot;], &quot;uniprot&quot; =&gt; [&quot;P0AFJ7&quot;], &quot;ecogene&quot; =&gt; [&quot;EG12230&quot;], &quot;ncbigene&quot; =&gt; [&quot;948009&quot;], &quot;ncbigi&quot; =&gt; [&quot;16131365&quot;], &quot;refseq_locus_tag&quot; =&gt; [&quot;b3493&quot;], &quot;refseq_name&quot; =&gt; [&quot;pitA&quot;], &quot;asap&quot; =&gt; [&quot;ABE-0011407&quot;], &quot;refseq_synonym&quot; =&gt; [&quot;pit&quot;, &quot;ECK3478&quot;, &quot;JW3460&quot;]), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;b3493&quot;])), &quot;b2926&quot; =&gt; AbstractFBCModels.CanonicalModel.Gene(&quot;pgk&quot;, Dict(&quot;sbo&quot; =&gt; [&quot;SBO:0000243&quot;], &quot;uniprot&quot; =&gt; [&quot;P0A799&quot;], &quot;ecogene&quot; =&gt; [&quot;EG10703&quot;], &quot;ncbigene&quot; =&gt; [&quot;947414&quot;], &quot;ncbigi&quot; =&gt; [&quot;16130827&quot;], &quot;refseq_locus_tag&quot; =&gt; [&quot;b2926&quot;], &quot;refseq_name&quot; =&gt; [&quot;pgk&quot;], &quot;asap&quot; =&gt; [&quot;ABE-0009605&quot;], &quot;refseq_synonym&quot; =&gt; [&quot;ECK2922&quot;, &quot;JW2893&quot;]), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;b2926&quot;])), &quot;b0979&quot; =&gt; AbstractFBCModels.CanonicalModel.Gene(&quot;cbdB&quot;, Dict(&quot;sbo&quot; =&gt; [&quot;SBO:0000243&quot;], &quot;uniprot&quot; =&gt; [&quot;P26458&quot;], &quot;ecogene&quot; =&gt; [&quot;EG11379&quot;], &quot;ncbigene&quot; =&gt; [&quot;947547&quot;], &quot;ncbigi&quot; =&gt; [&quot;16128945&quot;], &quot;refseq_locus_tag&quot; =&gt; [&quot;b0979&quot;], &quot;refseq_name&quot; =&gt; [&quot;cbdB&quot;], &quot;asap&quot; =&gt; [&quot;ABE-0003302&quot;], &quot;refseq_synonym&quot; =&gt; [&quot;JW0961&quot;, &quot;appB&quot;, &quot;cyxB&quot;, &quot;ECK0970&quot;]), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;b0979&quot;])), &quot;b2282&quot; =&gt; AbstractFBCModels.CanonicalModel.Gene(&quot;nuoH&quot;, Dict(&quot;sbo&quot; =&gt; [&quot;SBO:0000243&quot;], &quot;uniprot&quot; =&gt; [&quot;P0AFD4&quot;], &quot;ecogene&quot; =&gt; [&quot;EG12088&quot;], &quot;ncbigene&quot; =&gt; [&quot;946761&quot;], &quot;ncbigi&quot; =&gt; [&quot;16130217&quot;], &quot;refseq_locus_tag&quot; =&gt; [&quot;b2282&quot;], &quot;refseq_name&quot; =&gt; [&quot;nuoH&quot;], &quot;asap&quot; =&gt; [&quot;ABE-0007541&quot;], &quot;refseq_synonym&quot; =&gt; [&quot;JW2277&quot;, &quot;ECK2276&quot;]), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;b2282&quot;])), &quot;b2283&quot; =&gt; AbstractFBCModels.CanonicalModel.Gene(&quot;nuoG&quot;, Dict(&quot;sbo&quot; =&gt; [&quot;SBO:0000243&quot;], &quot;uniprot&quot; =&gt; [&quot;P33602&quot;], &quot;ecogene&quot; =&gt; [&quot;EG12087&quot;], &quot;ncbigene&quot; =&gt; [&quot;946762&quot;], &quot;ncbigi&quot; =&gt; [&quot;145698290&quot;], &quot;refseq_locus_tag&quot; =&gt; [&quot;b2283&quot;], &quot;refseq_name&quot; =&gt; [&quot;nuoG&quot;], &quot;asap&quot; =&gt; [&quot;ABE-0007543&quot;], &quot;refseq_synonym&quot; =&gt; [&quot;JW2278&quot;, &quot;ECK2277&quot;]), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;b2283&quot;])), &quot;b2416&quot; =&gt; AbstractFBCModels.CanonicalModel.Gene(&quot;ptsI&quot;, Dict(&quot;sbo&quot; =&gt; [&quot;SBO:0000243&quot;], &quot;uniprot&quot; =&gt; [&quot;P08839&quot;], &quot;ecogene&quot; =&gt; [&quot;EG10789&quot;], &quot;ncbigene&quot; =&gt; [&quot;946879&quot;], &quot;ncbigi&quot; =&gt; [&quot;16130342&quot;], &quot;refseq_locus_tag&quot; =&gt; [&quot;b2416&quot;], &quot;refseq_name&quot; =&gt; [&quot;ptsI&quot;], &quot;asap&quot; =&gt; [&quot;ABE-0007967&quot;], &quot;refseq_synonym&quot; =&gt; [&quot;ECK2411&quot;, &quot;ctr&quot;, &quot;JW2409&quot;]), Dict(&quot;original_bigg_ids&quot; =&gt; [&quot;b2416&quot;]))…), Dict{String, AbstractFBCModels.CanonicalModel.Coupling}()), Dict{String, Dict{String, COBREXA.Isozyme}}(&quot;PFK&quot; =&gt; Dict(&quot;isozyme_1&quot; =&gt; COBREXA.Isozyme(Dict(&quot;b1723&quot; =&gt; 1.0), 3601.6560000000004, nothing)), &quot;PTAr&quot; =&gt; Dict(&quot;isozyme_2&quot; =&gt; COBREXA.Isozyme(Dict(&quot;b2458&quot; =&gt; 1.0), 4219.092000000001, nothing)), &quot;TKT2&quot; =&gt; Dict(&quot;isozyme_2&quot; =&gt; COBREXA.Isozyme(Dict(&quot;b2935&quot; =&gt; 1.0), 1682.712, nothing)), &quot;PGL&quot; =&gt; Dict(&quot;isozyme_1&quot; =&gt; COBREXA.Isozyme(Dict(&quot;b0767&quot; =&gt; 1.0), 7633.512000000001, nothing)), &quot;ACALD&quot; =&gt; Dict(&quot;isozyme_1&quot; =&gt; COBREXA.Isozyme(Dict(&quot;b0351&quot; =&gt; 1.0), 2045.1960000000001, nothing)), &quot;PGI&quot; =&gt; Dict(&quot;isozyme_1&quot; =&gt; COBREXA.Isozyme(Dict(&quot;b4025&quot; =&gt; 1.0), 1685.1960000000001, nothing)), &quot;ALCD2x&quot; =&gt; Dict(&quot;isozyme_3&quot; =&gt; COBREXA.Isozyme(Dict(&quot;b1478&quot; =&gt; 1.0), 273.42, nothing)), &quot;PGK&quot; =&gt; Dict(&quot;isozyme_1&quot; =&gt; COBREXA.Isozyme(Dict(&quot;b2926&quot; =&gt; 1.0), 207.50400000000002, nothing)), &quot;ICDHyr&quot; =&gt; Dict(&quot;isozyme_1&quot; =&gt; COBREXA.Isozyme(Dict(&quot;b1136&quot; =&gt; 1.0), 142.632, nothing)), &quot;PDH&quot; =&gt; Dict(&quot;isozyme_1&quot; =&gt; COBREXA.Isozyme(Dict(&quot;b0114&quot; =&gt; 1.0, &quot;b0115&quot; =&gt; 1.0, &quot;b0116&quot; =&gt; 1.0), 1907.136, nothing))…))</code></pre><p>Since we will later be differentiating our solution, we need to make parameter isozymes and a kinetic model</p><pre><code class="language-julia hljs">parameter_values = Dict(
    Symbol(x) =&gt; iso.kcat_forward for (x, y) in pruned_reaction_isozymes for (_, iso) in y
)

rid_kcat = Dict(k =&gt; Ex(Symbol(k)) for (k, _) in parameter_values)
parameter_isozymes = Dict(
    x =&gt; Dict(
        &quot;isozyme&quot; =&gt; X.IsozymeT{Ex}(
            iso.gene_product_stoichiometry,
            rid_kcat[Symbol(x)],
            nothing,
        ) for (_, iso) in y
    ) for (x, y) in pruned_reaction_isozymes
)

pkm = X.enzyme_constrained_flux_balance_constraints( # kinetic model
    pruned_model;
    reaction_isozymes=parameter_isozymes,
    gene_product_molar_masses,
    capacity,
)

pruned_solution = D.optimized_values(
    pkm,
    parameter_values;
    objective=pkm.objective.value,
    optimizer=T.Optimizer,
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(tree = ConstraintTrees.Tree{Float64}(#= 12 elements =#), primal_values = [41.69304582306297, 3.3738864917780025, 0.7991675278074312, 0.7991675278074535, 3.373886491778005, 41.69304582306298, 8.390000014263562, 0.7407243746482269, 53.669001513849246, 0.7991675278074185  …  0.0029929638145053954, 0.019613928519562524, 0.070652071827256, 0.04032874991388847, 0.001959493158657936, 0.15248718390411423, 0.001389701890214975, 0.0011621347499833816, 0.001689819318361655, 0.0203858436174642], equality_dual_values = [0.02492930687014489, 0.014760868846430996, 0.014596725288290495, 0.014965230475163616, 0.015197498948580045, -0.00031185145643069606, 0.0, 0.004922650431641902, 0.00602434591003517, 0.03343676205069087  …  0.0011008155494533034, 0.0027816413336696046, 0.00014303200199665392, 6.0870518424461934e-5, 0.0014429753769459965, 0.0009355543548025853, 0.0015010372952537607, 0.0010786131569188657, 0.0007180292162103088, 0.00017951934251539064], inequality_dual_values = [-1.3851828240284269e-12, -5.011795376759092e-11, -3.709882083649073e-11, -3.874176899575392e-11, -5.072428333116834e-11, -1.4179922937351746e-12, -0.012547259306716914, -4.26844003327565e-11, -6.870164106469038e-13, -3.324292443370856e-11  …  -3.7987563045117077e-14, -3.790555906101654e-14, -9.777251415316644e-14, 0.0, -3.7867994935268234e-14, -3.785540430565886e-14, -3.781840397270636e-14, -4.6375268684640907e-14, -0.016731799175476156, -0.01735886145395185])</code></pre><p>All reactions with zero flux have been removed in the pruned model</p><pre><code class="language-julia hljs">sort(collect(pruned_solution.tree.fluxes), by=ComposedFunction(abs, last))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">52-element Vector{Pair{Symbol, Union{Float64, ConstraintTrees.Tree{Float64}}}}:
                     :GLNS =&gt; 0.18940322259736744
 :BIOMASS_Ecoli_core_w_GAM =&gt; 0.7407243746482269
                       :CS =&gt; 0.7991675278074185
                   :ACONTa =&gt; 0.7991675278074312
                   :ACONTb =&gt; 0.7991675278074535
                   :ICDHyr =&gt; 0.7991675278074873
                     :TKT2 =&gt; 1.716838610153485
                     :TALA =&gt; 1.9842401094015332
                     :TKT1 =&gt; 1.9842401094015338
                      :PPC =&gt; 2.1226197679914267
                           ⋮
                 :SUCCt2_2 =&gt; 45.10175150771673
                   :SUCCt3 =&gt; 45.101751507716735
                      :PDH =&gt; 48.642186653954965
                      :ENO =&gt; 53.247640453329765
                      :PGM =&gt; 53.247640453329765
                     :CO2t =&gt; 53.669001513849246
                 :EX_co2_e =&gt; 53.669001513849246
                      :PGK =&gt; 54.35576411780352
                     :GAPD =&gt; 54.35576411780354</code></pre><p>Genes with zero concentration have also been removed.</p><pre><code class="language-julia hljs">sort(abs.(collect(values(pruned_solution.tree.gene_product_amounts))))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">49-element Vector{Float64}:
 0.0005800203793505351
 0.0005856841395960682
 0.0007996712306205315
 0.0008318932491454554
 0.001689819318361655
 0.001959493158657936
 0.0025518366401983566
 0.0027916453170659383
 0.0029929638145053954
 0.0032366263256029797
 ⋮
 0.034702381966990506
 0.034702381966990506
 0.04032874991388847
 0.04032874991388847
 0.05349843841361214
 0.070652071827256
 0.1172633066639992
 0.15248718390411423
 0.26195044007731577</code></pre><h2 id="Optimal-flux-modes-(OFMs)"><a class="docs-heading-anchor" href="#Optimal-flux-modes-(OFMs)">Optimal flux modes (OFMs)</a><a id="Optimal-flux-modes-(OFMs)-1"></a><a class="docs-heading-anchor-permalink" href="#Optimal-flux-modes-(OFMs)" title="Permalink"></a></h2><p>We now wish to find the optimal flux modes (OFMs) of this optimal solution.</p><p>In our model, we have a fixed ATP maintenance flux</p><pre><code class="language-julia hljs">pruned_model.reactions[&quot;ATPM&quot;].lower_bound</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">8.39</code></pre><p>As a result of this fixed flux, standard EFM theory does not hold. Instead, we investigate the optimal flux modes (OFMs). These are the flux modes that are able to produce the optimal rate of the objective, whilst still being constrained to the fixed ATPM.</p><p>To find the OFMs, we must augment the stoichiometric matrix, and can then use the same <code>find_efms</code> function, since this augmented matrix behaves as required for the algorithm to work.</p><pre><code class="language-julia hljs">N = A.stoichiometry(pruned_model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">55×52 SparseArrays.SparseMatrixCSC{Float64, Int64} with 205 stored entries:
⎡⠀⠀⠀⠠⠀⠐⠀⠀⠀⠀⠀⠀⠁⠀⡀⠀⠀⠀⠨⡰⠀⠀⠀⠀⠀⠀⎤
⎢⡐⠀⢆⠀⠀⠀⠠⠀⠀⠀⠀⠈⠀⠀⠀⠀⠀⠀⠀⠁⠀⠀⠀⠀⠀⠀⎥
⎢⢡⠒⠀⣈⠈⠀⠀⠀⠀⠀⠀⠀⠀⡀⠀⠀⠀⢁⢀⠀⠀⢅⠀⠀⠀⠀⎥
⎢⠐⠄⠀⠚⡠⠀⠀⠀⠀⠀⠀⠀⠀⠊⡀⡁⠀⡐⠐⠀⢀⠐⠀⠀⠀⠀⎥
⎢⠂⠀⠀⢐⠑⠀⠀⠁⠀⠀⠀⠄⠀⠀⠀⠀⠀⠂⠀⠀⠀⠂⠀⠀⡀⡠⎥
⎢⠀⠀⠈⠠⠀⠀⠃⠐⠀⠀⠀⡀⠀⠀⠀⠀⠀⢠⠄⠀⠀⠀⠀⠀⠄⠄⎥
⎢⠀⠀⠀⢘⠀⠀⠀⠀⠄⠀⠀⠑⠱⡀⠀⠀⠀⠀⠂⠀⠀⠀⠀⠀⠉⠉⎥
⎢⡀⠒⣀⣚⢐⡒⡀⠀⠠⠀⠀⢀⡀⣙⠰⢀⠀⢀⠀⡂⣐⢀⠀⣀⠀⠀⎥
⎢⡄⠐⢡⢠⠀⠁⠁⠀⠀⠁⠀⠀⡄⠀⠀⢪⠀⡄⠀⠀⠁⠀⠀⠉⠀⠀⎥
⎢⠀⠀⠀⠘⠀⠀⠀⠀⠀⢀⠀⠘⠀⠼⠃⠃⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⎥
⎢⠀⠀⠀⢠⠠⢁⠀⠀⠀⠀⠂⠀⢀⠀⠀⠀⠘⠀⠀⠀⢠⢀⠀⠀⠀⠀⎥
⎢⠀⠀⠀⠩⠀⡀⠀⠀⠀⠀⠐⠀⠡⠁⠀⢀⠀⠄⠀⠀⠋⠡⠀⠀⠀⠀⎥
⎢⠀⠀⠀⠐⠀⠁⠀⠀⠀⠀⠀⠀⠀⠀⠄⠈⠀⠀⠀⠀⠀⠀⠴⠀⣐⠀⎥
⎣⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠄⠛⠠⠄⎦</code></pre><p>Take the fixed fluxes (here only ATPM) and the objective flux</p><pre><code class="language-julia hljs">atpm_idx = findfirst(x -&gt; x == &quot;ATPM&quot;, A.reactions(pruned_model))
biomass_idx = findfirst(x -&gt; x == &quot;BIOMASS_Ecoli_core_w_GAM&quot;, A.reactions(pruned_model))
fixed_fluxes = [atpm_idx, biomass_idx]
flux_values = [
    pruned_solution.tree.fluxes[&quot;ATPM&quot;],
    pruned_solution.tree.fluxes[&quot;BIOMASS_Ecoli_core_w_GAM&quot;],
]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 8.390000014263562
 0.7407243746482269</code></pre><p>Calculate the OFMs, using the <code>get_ofms</code> function</p><pre><code class="language-julia hljs">OFMs = get_ofms(Matrix(N), fixed_fluxes, flux_values)
OFM_dicts = [
    Dict(A.reactions(pruned_model) .=&gt; OFMs[:, 1]),
    Dict(A.reactions(pruned_model) .=&gt; OFMs[:, 2]),
]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Dict{String, Float64}}:
 Dict(&quot;NH4t&quot; =&gt; 4.039021870081851, &quot;ACALD&quot; =&gt; 48.44081880661824, &quot;PTAr&quot; =&gt; 0.0, &quot;PGL&quot; =&gt; 6.350267100077981, &quot;ALCD2x&quot; =&gt; 48.44081880661824, &quot;PGK&quot; =&gt; 57.72965060958195, &quot;PDH&quot; =&gt; 52.01607314573287, &quot;CO2t&quot; =&gt; 57.04288800562686, &quot;PYK&quot; =&gt; 23.206660196868704, &quot;EX_nh4_e&quot; =&gt; 4.039021870081851…)
 Dict(&quot;NH4t&quot; =&gt; 4.039021870081861, &quot;ACALD&quot; =&gt; 0.0, &quot;PTAr&quot; =&gt; 24.22040940330914, &quot;PGL&quot; =&gt; 6.3502671000779864, &quot;ALCD2x&quot; =&gt; 0.0, &quot;PGK&quot; =&gt; 33.50924120627286, &quot;PDH&quot; =&gt; 27.795663742423752, &quot;CO2t&quot; =&gt; 32.82247860231776, &quot;PYK&quot; =&gt; 11.096455495214123, &quot;EX_nh4_e&quot; =&gt; 4.039021870081861…)</code></pre><p>Scale the OFMs to have one unit flux through biomass</p><pre><code class="language-julia hljs">OFM_dicts = [
    Dict(x =&gt; y / OFM_dicts[1][&quot;BIOMASS_Ecoli_core_w_GAM&quot;] for (x, y) in OFM_dicts[1]),
    Dict(x =&gt; y / OFM_dicts[2][&quot;BIOMASS_Ecoli_core_w_GAM&quot;] for (x, y) in OFM_dicts[2]),
]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Dict{String, Float64}}:
 Dict(&quot;ACALD&quot; =&gt; 65.39655027502367, &quot;PTAr&quot; =&gt; 0.0, &quot;ALCD2x&quot; =&gt; 65.39655027502367, &quot;PDH&quot; =&gt; 70.22325027502372, &quot;CO2t&quot; =&gt; 77.0096002750237, &quot;PYK&quot; =&gt; 31.3296834708452, &quot;EX_nh4_e&quot; =&gt; 5.452799999999999, &quot;CS&quot; =&gt; 1.0789000000000004, &quot;PGM&quot; =&gt; 76.44075027502372, &quot;TKT1&quot; =&gt; 2.678783333333333…)
 Dict(&quot;ACALD&quot; =&gt; 0.0, &quot;PTAr&quot; =&gt; 32.698275137511864, &quot;ALCD2x&quot; =&gt; 0.0, &quot;PDH&quot; =&gt; 37.52497513751188, &quot;CO2t&quot; =&gt; 44.3113251375119, &quot;PYK&quot; =&gt; 14.980545902089256, &quot;EX_nh4_e&quot; =&gt; 5.452800000000012, &quot;CS&quot; =&gt; 1.0788999999999962, &quot;PGM&quot; =&gt; 43.74247513751189, &quot;TKT1&quot; =&gt; 2.678783333333335…)</code></pre><p>We see that the first OFM is releasing ethanol but not acetate</p><pre><code class="language-julia hljs">OFM_dicts[1][&quot;EX_etoh_e&quot;]
OFM_dicts[1][&quot;EX_ac_e&quot;]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0</code></pre><p>And the second OFM is releasing acetate but no ethanol</p><pre><code class="language-julia hljs">OFM_dicts[2][&quot;EX_etoh_e&quot;]
OFM_dicts[2][&quot;EX_ac_e&quot;]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">32.698275137511864</code></pre><h2 id="Differentiate-OFM-usage"><a class="docs-heading-anchor" href="#Differentiate-OFM-usage">Differentiate OFM usage</a><a id="Differentiate-OFM-usage-1"></a><a class="docs-heading-anchor-permalink" href="#Differentiate-OFM-usage" title="Permalink"></a></h2><p>The weighted sum of these two OFMs is equal to the whole optimal flux solution, and can be easily calculated using two non-shared reactions</p><pre><code class="language-julia hljs">M = [
    OFM_dicts[1][&quot;EX_etoh_e&quot;] OFM_dicts[2][&quot;EX_etoh_e&quot;]
    OFM_dicts[1][&quot;EX_ac_e&quot;] OFM_dicts[2][&quot;EX_ac_e&quot;]
]

v = [
    pruned_solution.tree.fluxes[&quot;EX_etoh_e&quot;]
    pruned_solution.tree.fluxes[&quot;EX_ac_e&quot;]
]

λ = M \ v</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Float64}:
 0.6375419750388028
 0.10318239960943508</code></pre><p><code>λ</code> tells us the weighting of the two OFMs, so here we have 0.6 units of flux through OFM₁ and 0.1 units of flux through OFM₂ to produce our optimal biomass.</p><p>It is of interest to see how changes in the kinetic parameters affect this optimal weighting.</p><pre><code class="language-julia hljs">parameters = Ex.(collect(keys(parameter_values)))
rid_gcounts = Dict(
    rid =&gt; [v.gene_product_stoichiometry for (k, v) in d][1] for
    (rid, d) in pruned_reaction_isozymes
)
rid_pid =
    Dict(rid =&gt; [iso.kcat_forward for (k, iso) in v][1] for (rid, v) in parameter_isozymes)
sens = differentiate_ofm(
    OFM_dicts,
    parameters,
    rid_pid,
    parameter_values,
    rid_gcounts,
    capacity,
    gene_product_molar_masses,
    T.Optimizer,
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×33 Matrix{Float64}:
  2.34957e-6  -3.24672e-6   3.25167e-5   8.97662e-7   2.81279e-6   1.09438e-6  …   5.32262e-6   1.64894e-6   8.33172e-6  -4.56087e-5   0.000106976
 -9.72454e-7   6.36629e-6  -1.34582e-5  -3.71529e-7  -1.16417e-6  -4.52948e-7     -2.20296e-6  -6.82471e-7  -3.44838e-6   8.94313e-5  -4.42758e-5</code></pre><p>To get control coefficients instead of sensititivities, we scale these derivatives.</p><pre><code class="language-julia hljs">scaled_sens = Matrix(undef, size(sens, 1), size(sens, 2))
for (i, col) in enumerate(eachcol(sens))
    scaled_sens[:, i] = collect(values(parameter_values))[i] .* col ./ λ
end</code></pre><p>We plot the control coefficients to get a visual overview of the system.</p><pre><code class="language-julia hljs">sens_perm = sortperm(scaled_sens[1, :])
scaled_sens[:, sens_perm]
parameters[sens_perm]


f, a, hm = heatmap(
    scaled_sens[:, sens_perm]&#39;;
    colormap=CairoMakie.Reverse(:RdBu),
    axis=(
        yticks=(1:2, [&quot;Ethanol producing&quot;, &quot;Acetate producing&quot;]),
        yticklabelrotation=pi / 2,
        xticklabelrotation=pi / 2,
        xlabel=&quot;Parameters&quot;,
        ylabel=&quot;Control coefficient, param/λ * ∂λ/∂param&quot;,
        xticks=(1:length(parameters), string.(parameters[sens_perm])),
        title=&quot;Control coefficients of OFM weightings in optimal solution&quot;,
        ylabelsize=23,
        xlabelsize=23,
        titlesize=25,
    ),
);
Colorbar(f[:, end+1], hm)
f</code></pre><img src="44821e36.png" alt="Example block output"/><p>We see that most kinetic parameters have little effect on the optimal OFM weightings, see the reactions from RPE to PGI. Those parameters that do affect optimal weightings always increase the use of one OFM and decrease the use of the other.</p><p>Increasing the turnover number of PGK is predicted to decrease the optimal flux through the acetate producing OFM, and increase the optimal flux through the ethanol producing OFM.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../2-differentiate/">« Sensitivities of the EFMs of a toy model</a><a class="docs-footer-nextpage" href="../reference/">Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Tuesday 28 January 2025 16:14">Tuesday 28 January 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Reference · ElementaryFluxModes.jl</title><meta name="title" content="Reference · ElementaryFluxModes.jl"/><meta property="og:title" content="Reference · ElementaryFluxModes.jl"/><meta property="twitter:title" content="Reference · ElementaryFluxModes.jl"/><meta name="description" content="Documentation for ElementaryFluxModes.jl."/><meta property="og:description" content="Documentation for ElementaryFluxModes.jl."/><meta property="twitter:description" content="Documentation for ElementaryFluxModes.jl."/><meta property="og:url" content="https://hettiec.github.io/ElementaryFluxModes.jl/reference/"/><meta property="twitter:url" content="https://hettiec.github.io/ElementaryFluxModes.jl/reference/"/><link rel="canonical" href="https://hettiec.github.io/ElementaryFluxModes.jl/reference/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ElementaryFluxModes.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">README</a></li><li><a class="tocitem" href="../1-toy-model/">Calculating EFMs in a toy model</a></li><li><a class="tocitem" href="../2-differentiate/">Sensitivities of the EFMs of a toy model</a></li><li><a class="tocitem" href="../3-ecoli-core/">Sensitivities of OFMs in <em>E. coli</em> core</a></li><li class="is-active"><a class="tocitem" href>Reference</a><ul class="internal"><li><a class="tocitem" href="#Binary-DD"><span>Binary DD</span></a></li><li><a class="tocitem" href="#Differentiating"><span>Differentiating</span></a></li><li><a class="tocitem" href="#Utilities"><span>Utilities</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/HettieC/ElementaryFluxModes.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/HettieC/ElementaryFluxModes.jl/blob/main/docs/src/reference.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h1><h2 id="Binary-DD"><a class="docs-heading-anchor" href="#Binary-DD">Binary DD</a><a id="Binary-DD-1"></a><a class="docs-heading-anchor-permalink" href="#Binary-DD" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElementaryFluxModes.DDBinary-Tuple{Any, Any}" href="#ElementaryFluxModes.DDBinary-Tuple{Any, Any}"><code>ElementaryFluxModes.DDBinary</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DDBinary(N, K) -&gt; Any
</code></pre><p>Implement the Double Description method in binary form. The input variables are: -<code>N</code>: the stoichiometric matrix with only forward reactions. If any fluxes are fixed then N has the form [N1 w] where N1 is the stoichiometric matrix for non-fixed fluxes, and w is the columns of fixed fluxes multiplied by their flux values. -<code>K</code>: initial nullspace of N, in the form [I;K*] Output: -<code>R</code>: binary elementary flux modes</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HettieC/ElementaryFluxModes.jl/blob/e78c4fc6248159a7353734f5b44757f700f4a3d7/src/DDBinary.jl#L126">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElementaryFluxModes.check_adjacency-Tuple{Any, Any, Any}" href="#ElementaryFluxModes.check_adjacency-Tuple{Any, Any, Any}"><code>ElementaryFluxModes.check_adjacency</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">check_adjacency(i, j, R) -&gt; Bool
</code></pre><p>Check adjacency of columns i and j in r by making sure that there exists no other extreme ray in R whose zero set is a superset of the intersection of the zero sets of ray i and ray j.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HettieC/ElementaryFluxModes.jl/blob/e78c4fc6248159a7353734f5b44757f700f4a3d7/src/DDBinary.jl#L234">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElementaryFluxModes.get_efms-Tuple{Matrix{Float64}}" href="#ElementaryFluxModes.get_efms-Tuple{Matrix{Float64}}"><code>ElementaryFluxModes.get_efms</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_efms(N::Matrix{Float64}; tol) -&gt; Any
</code></pre><p>Calculate elementary flux modes of a stoichiometric matrix. Input: <code>N</code>: the stoichiometric matrix of a network with only forward reactions. Output: matrix of the EFMs, each column is a different EFM, rows correspond to the reaction indices of the input <code>N</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HettieC/ElementaryFluxModes.jl/blob/e78c4fc6248159a7353734f5b44757f700f4a3d7/src/DDBinary.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElementaryFluxModes.get_ofms-Tuple{Matrix{Float64}, Vector{Int64}, Vector{Float64}}" href="#ElementaryFluxModes.get_ofms-Tuple{Matrix{Float64}, Vector{Int64}, Vector{Float64}}"><code>ElementaryFluxModes.get_ofms</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_ofms(
    N::Matrix{Float64},
    fixed_fluxes::Vector{Int64},
    flux_values::Vector{Float64}
) -&gt; Any
</code></pre><p>Calculate the optimal flux modes of a pruned optimal solution. Arguments:</p><ul><li><code>N</code>: the stoichiometric matrix of a pruned model</li><li><code>fixed_fluxes</code>: the indexes of the fixed fluxes</li><li><code>flux_values</code>: the optimal values of the fixed fluxes</li></ul><p>Output: matrix of the OFMs, each column is a different OFM, rows correspond to the reaction indices of the input <code>N</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HettieC/ElementaryFluxModes.jl/blob/e78c4fc6248159a7353734f5b44757f700f4a3d7/src/DDBinary.jl#L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElementaryFluxModes.make_bitmap-Tuple{Any}" href="#ElementaryFluxModes.make_bitmap-Tuple{Any}"><code>ElementaryFluxModes.make_bitmap</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">make_bitmap(row) -&gt; Vector{Bool}
</code></pre><p>Return a bitmap of the input vector, where entries are 1 if the vector entry is greater than zero, and zero if the entries are zero. Return an error if any entries of the vector are less than zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HettieC/ElementaryFluxModes.jl/blob/e78c4fc6248159a7353734f5b44757f700f4a3d7/src/DDBinary.jl#L205">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElementaryFluxModes.rational_nullspace-Tuple{Matrix}" href="#ElementaryFluxModes.rational_nullspace-Tuple{Matrix}"><code>ElementaryFluxModes.rational_nullspace</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rational_nullspace(
    A::Matrix;
    tol
) -&gt; Tuple{Matrix{Float64}, Any}
</code></pre><p>Helper function to calculate a nullspace of the matrix A, with all rational entries.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HettieC/ElementaryFluxModes.jl/blob/e78c4fc6248159a7353734f5b44757f700f4a3d7/src/DDBinary.jl#L175">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElementaryFluxModes.zero_set-Tuple{Any}" href="#ElementaryFluxModes.zero_set-Tuple{Any}"><code>ElementaryFluxModes.zero_set</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">zero_set(vec) -&gt; Vector
</code></pre><p>Return the zero set of a vector</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HettieC/ElementaryFluxModes.jl/blob/e78c4fc6248159a7353734f5b44757f700f4a3d7/src/DDBinary.jl#L227">source</a></section></article><h2 id="Differentiating"><a class="docs-heading-anchor" href="#Differentiating">Differentiating</a><a id="Differentiating-1"></a><a class="docs-heading-anchor-permalink" href="#Differentiating" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElementaryFluxModes._cost_matrix-Tuple{Vector{Dict{String, Float64}}, Any, Any, Vector{Tuple{String, Vector{String}, Float64}}, Dict{String, Float64}}" href="#ElementaryFluxModes._cost_matrix-Tuple{Vector{Dict{String, Float64}}, Any, Any, Vector{Tuple{String, Vector{String}, Float64}}, Dict{String, Float64}}"><code>ElementaryFluxModes._cost_matrix</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_cost_matrix(
    EFMs::Vector{Dict{String, Float64}},
    rid_pid,
    rid_gcounts,
    capacity::Vector{Tuple{String, Vector{String}, Float64}},
    gene_product_molar_masses::Dict{String, Float64};
    evaluate,
    parameter_values
) -&gt; Matrix{Any}
</code></pre><p>Calculate a matrix of the cost vectors of each EFM to each constraint. Entry (i,j) gives the total cost in constraint i to produce one unit objective flux through EFM j. Cost is calculated as ∑w(i)V(j)/kcat, where the variables are:</p><ul><li>&#39;w(i)&#39;: fraction of the ith enzyme pool that one mole of the enzyme uses up</li><li>&#39;V(j)&#39;: flux through the reaction in EFM j</li><li>&#39;kcat&#39;: turnover number of the enzyme.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HettieC/ElementaryFluxModes.jl/blob/e78c4fc6248159a7353734f5b44757f700f4a3d7/src/differentiate_efm.jl#L90">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElementaryFluxModes.differentiate_efm-Tuple{Vector{Dict{String, Float64}}, Vector{FastDifferentiation.Node}, Dict{String, FastDifferentiation.Node}, Dict{Symbol, Float64}, Dict{String, Dict{String, Float64}}, Vector{Tuple{String, Vector{String}, Float64}}, Dict{String, Float64}, Any}" href="#ElementaryFluxModes.differentiate_efm-Tuple{Vector{Dict{String, Float64}}, Vector{FastDifferentiation.Node}, Dict{String, FastDifferentiation.Node}, Dict{Symbol, Float64}, Dict{String, Dict{String, Float64}}, Vector{Tuple{String, Vector{String}, Float64}}, Dict{String, Float64}, Any}"><code>ElementaryFluxModes.differentiate_efm</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">differentiate_efm(
    EFMs::Vector{Dict{String, Float64}},
    parameters::Vector{FastDifferentiation.Node},
    rid_pid::Dict{String, FastDifferentiation.Node},
    parameter_values::Dict{Symbol, Float64},
    rid_gcounts::Dict{String, Dict{String, Float64}},
    capacity::Vector{Tuple{String, Vector{String}, Float64}},
    gene_product_molar_masses::Dict{String, Float64},
    optimizer
) -&gt; Any
</code></pre><p>Differentiate the usage of EFMs with respect to changes in the model parameters using implicit differentiation of the Lagrangian. Calculating the proportion of each EFM used in the optimal solution can be turned into the following LP:     maximise     ∑xᵢ     subject to   Dx = 1 where D is the cost matrix associated to each EFM in each enzyme pool. We then differentiate Lagrangian of this LP to calculate the differential of x by parameters.</p><p>Arguments:</p><ul><li>&#39;EFMs&#39;: a vector of dictionaries of EFMs</li><li>&#39;parameters&#39;: vector of the model parameters</li><li><code>rid_pid</code>: dict of reaction ids =&gt; parameter ids</li><li><code>parameter_values</code>: dict of parameter symbol =&gt; float value</li><li><code>rid_gcounts</code>: dict of reaction id =&gt; gene product counts</li><li><code>capacity</code>: enzyme capacity limit of the enzyme constrained model</li><li><code>gene_product_molar_masses</code>: dict of gene product gene<em>product</em>molar_masses</li></ul><p>Output: Matrix Aᵢⱼ of the the differential of EFM i with respect to parameter j: d(EFMᵢ)/d(pⱼ)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HettieC/ElementaryFluxModes.jl/blob/e78c4fc6248159a7353734f5b44757f700f4a3d7/src/differentiate_efm.jl#L1">source</a></section></article><h2 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElementaryFluxModes.remove_linearly_dep_rows_qr-Tuple{Any}" href="#ElementaryFluxModes.remove_linearly_dep_rows_qr-Tuple{Any}"><code>ElementaryFluxModes.remove_linearly_dep_rows_qr</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">remove_linearly_dep_rows_qr(A) -&gt; Any
</code></pre><p>Helper function to remove linearly dependent rows of the matrix A, taken from DifferentiableMetabolism.jl, using QR decomposition.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HettieC/ElementaryFluxModes.jl/blob/e78c4fc6248159a7353734f5b44757f700f4a3d7/src/utils.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ElementaryFluxModes.reorder_ns-Tuple{Matrix}" href="#ElementaryFluxModes.reorder_ns-Tuple{Matrix}"><code>ElementaryFluxModes.reorder_ns</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">reorder_ns(A::Matrix) -&gt; Tuple{Matrix, Vector{Int64}}
</code></pre><p>Helper function to reorder the rows of the nullspace so that it is in the form [I; K].</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/HettieC/ElementaryFluxModes.jl/blob/e78c4fc6248159a7353734f5b44757f700f4a3d7/src/utils.jl#L36">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../3-ecoli-core/">« Sensitivities of OFMs in <em>E. coli</em> core</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Tuesday 28 January 2025 17:10">Tuesday 28 January 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
